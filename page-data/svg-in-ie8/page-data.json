{"componentChunkName":"component---src-templates-blog-post-js","path":"/svg-in-ie8","result":{"data":{"markdownRemark":{"html":"<p>В очередной раз встретившись с теми же граблями, я всё-таки решила описать суть проблемы и пути её решения. Речь пойдет о том, как заставить старые браузеры понимать и отображать SVG-элементы — хотя бы пустой блок заданных размеров.<!--more--></p>\n<p>Предположим, вам понадобились SVG-иконки. Вы планируете перекрашивать их по наведению или взаимодействовать с ними как-то ещё, поэтому в качестве способа вставки выбираете не <code>background-image</code>, а <code>use</code>.</p>\n<p>Подразумевается, что вы подготовили библиотеку иконок и вставили её на страницу.</p>\n<p>Для примера возьму такой символ:</p>\n<div class=\"gatsby-highlight\" data-language=\"markup\"><pre class=\"language-markup\"><code class=\"language-markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>symbol</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>s-heart<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">viewBox</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>0 0 100 100<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span> <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>M100 34.976c0 8.434-3.635 16.019-9.423 21.274h0.048l-31.25 31.25c-3.125 3.125-6.25 6.25-9.375 6.25s-6.25-3.125-9.375-6.25l-31.202-31.25c-5.788-5.255-9.423-12.84-9.423-21.274 0-15.865 12.861-28.726 28.726-28.726 8.434 0 16.019 3.635 21.274 9.423 5.255-5.788 12.84-9.423 21.274-9.423 15.865 0 28.726 12.861 28.726 28.726z<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>crimson<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>symbol</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Теперь иконку надо вставить в нужное место. Первым делом пишем такое:</p>\n<div class=\"gatsby-highlight\" data-language=\"markup\"><pre class=\"language-markup\"><code class=\"language-markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>svg</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>use</span> <span class=\"token attr-name\"><span class=\"token namespace\">xlink:</span>href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>#s-heart<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>svg</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><i>Да, я знаю, что в теге нужно указывать пространство имен, чтобы все браузеры правильно понимали тег. Но до сих пор я не сталкивалась с проблемами в отображении такой конструкции, и мне всегда было интересно: а если его не указывать — что и где поломается? Всегда ли мы должны дописывать такой длинный хвост к такому короткому тегу?</i></p>\n<p><code>viewBox</code> уже задан в символе, поэтому его не нужно указывать в <code>svg</code> при вставке на страницу, потребуется задать только размеры иконки.</p>\n<p>Задаем размеры:</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">SVG</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 100px<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 100px<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Конструкция работает во всех браузерах, которые поддерживают SVG.</p>\n<p>Теперь нужно позаботиться о старых браузерах и добавить иконке фоновый PNG. Пишем что-нибудь типа:</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">SVG</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 100px<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 100px<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token url\"><span class=\"token function\">url</span><span class=\"token punctuation\">(</span>heart.png<span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><i>Обычно фоновая картинка задается только для старых браузеров, например по классу <code>.lt-ie9 SVG</code>, но здесь я опустила этот момент для простоты.</i></p>\n<p>Что получилось:</p>\n<iframe height=\"250\"\n      style=\"width: 100%\"\n      title=\"no title\"\n      src=\"http://codepen.io/yoksel/embed/KnALd/?&default-tab=result\"\n    ></iframe>\n<p>Ссылка на случай, если вы смотрите в IE8, и фрейм не отобразился: <a href=\"http://codepen.io/yoksel/full/KnALd\">codepen.io/yoksel/pen/KnALd</a></p>\n<p>Проверяем в 8-м IE и видим, что ничего не работает, причем сразу по нескольким причинам:</p>\n<ol>\n<li>SVG-элемент не существует с точки зрения IE8. Чтобы браузер начал догадываться о его существовании, нужно в тег <code>svg</code> добавить пространство имен, к которому он принадлежит: <code>xmlns=\"<a href=\"http://www.w3.org/2000/svg%22\">http://www.w3.org/2000/svg\"</a></code>.</li>\n<li>IE8 не понимает обращение к SVG-элементу по тегу — только по классу.</li>\n<li>SVG-элементу обязательно нужно добавить <code>display: block</code> или <code>display: inline-block</code>.</li>\n</ol>\n<p>Исправляем код и получаем вот такое:</p>\n<div class=\"gatsby-highlight\" data-language=\"markup\"><pre class=\"language-markup\"><code class=\"language-markup\"><span class=\"token comment\">&lt;!-- добавлены класс и пространство имен --></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>svg</span> <span class=\"token attr-name\">xmlns</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>http://www.w3.org/2000/svg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>svg-icon<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>use</span> <span class=\"token attr-name\"><span class=\"token namespace\">xlink:</span>href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>#s-heart<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>svg</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token comment\">/* стили перенесены на класс, добавлен display: inline-block */</span>\n<span class=\"token selector\">.svg-icon</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> inline-block<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 100px<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 100px<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> <span class=\"token url\"><span class=\"token function\">url</span><span class=\"token punctuation\">(</span>heart.png<span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Результат:</p>\n<iframe height=\"250\"\n      style=\"width: 100%\"\n      title=\"no title\"\n      src=\"http://codepen.io/yoksel/embed/kABcb/?&default-tab=result\"\n    ></iframe>\n<p>Ссылка: <a href=\"http://codepen.io/yoksel/full/kABcb\">codepen.io/yoksel/full/kABcb</a></p>\n<p>SVG-элемент появился в IE8, только вместо векторного содержимого в нем будет фоновая картинка.</p>\n<p><i>Конечно можно не заморачиваться, обернуть SVG в тег <code>span</code>, например, и задавать фон и размеры ему, но зачем, если можно обойтись без дополнительной разметки?</i></p>\n<p>Вроде бы мы получили в IE8 SVG с фоллбеком, и все работает как надо, но проблемы на этом не заканчиваются. Если на странице есть HTML5-теги, верстка может разъехаться, если у элементов внутри SVG нет закрывающих парных тегов.</p>\n<p>Пример такой разметки:</p>\n<iframe height=\"500\"\n      style=\"width: 100%\"\n      title=\"no title\"\n      src=\"http://codepen.io/yoksel/embed/irvFb/?&default-tab=result\"\n    ></iframe>\n<p>Ссылка: <a href='http://codepen.io/yoksel/pen/irvFb/'>codepen.io/yoksel/pen/irvFb/</a></p>\n<p>Вот так это демо будет выглядет в 8-м IE:</p>\n<img src=\"http://img-fotki.yandex.ru/get/6734/5091629.a2/0_8591e_268b1c36_orig\" alt=\"Html5-tags in IE8\" title=\"Html5-tags in IE8\"/>\n<p>Html5shiv.js не может корректно отработать, из-за чего HTML5-теги не могут стать блочными.</p>\n<p>Решений тут два:</p>\n<ol>\n<li>Добавить в свой CSS явное указание <code>display: block</code> для HTML5-тегов.</li>\n<li>Закрывать все SVG-теги при вставке на страницу:</li>\n</ol>\n<p>Например, есть символ, содержащий <code>path</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"markup\"><pre class=\"language-markup\"><code class=\"language-markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>symbol</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>s-heart<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">viewBox</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>0 0 100 100<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span> <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>M100 34.976c0 ... 28.726 28.726z<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>symbol</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Добавляем закрывающий тег:</p>\n<div class=\"gatsby-highlight\" data-language=\"markup\"><pre class=\"language-markup\"><code class=\"language-markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>symbol</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>s-heart<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">viewBox</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>0 0 100 100<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span> <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>M100 34.976c0 ... 28.726 28.726z<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>path</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>symbol</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Аналогично надо сделать и для всех тегов <code>use</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"markup\"><pre class=\"language-markup\"><code class=\"language-markup\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>svg</span> <span class=\"token attr-name\">xmlns</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>http://www.w3.org/2000/svg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>svg-icon<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>use</span> <span class=\"token attr-name\"><span class=\"token namespace\">xlink:</span>href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>#s-heart<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>use</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>svg</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><a href=\"http://codepen.io/yoksel/pen/CujKg\">Исправленная разметка</a> будет корректно работать во всех браузерах.</p>\n<p>Надеюсь, эта статья сэкономит кому-то время в будущем, потому что известные грабли можно обойти не наступая. Да пребудет с вами сила SVG!</p>","frontmatter":{"title":"Грабли на чистом SVG","desc":"Предположим, вам понадобились SVG-иконки. Вы планируете перекрашивать их по наведению, поэтому в качестве способа вставки выбираете use. Как заставить старые браузеры понимать и отображать SVG-элементы — хотя бы пустой блок заданных размеров?","image":"http://img-fotki.yandex.ru/get/6734/5091629.a2/0_8591e_268b1c36_orig","customCSS":null,"customJs":null,"tags":["svg"],"layout":null,"links":null}}},"pageContext":{"slug":"svg-in-ie8","date":"03/10/2014","url":"/svg-in-ie8","type":"post","includeContent":"","isArchived":true,"previous":{"frontmatter":{"title":"Зачем я написала плагин для Grunt"},"fields":{"url":"/grunt-plugin","type":"post","isArchived":true}},"next":{"frontmatter":{"title":"Режимы наложения и их фоллбеки"},"fields":{"url":"/blend-modes-fallback","type":"post","isArchived":true}}}}}